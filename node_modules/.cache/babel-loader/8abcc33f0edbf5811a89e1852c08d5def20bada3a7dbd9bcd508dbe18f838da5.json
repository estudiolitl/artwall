{"ast":null,"code":"var _jsxFileName = \"/Users/litl/Dropbox/Jona/litl/proyectos/artwall/src/components/Canvas/Canvas.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useGesture } from 'react-use-gesture';\nimport * as S from './Canvas.styles';\nimport Image from '../Image/Image';\nimport useCanvas from '../../hooks/useCanvas';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CANVAS_SIZE = 20000;\nconst MIN_ZOOM = 0.1;\nconst MAX_ZOOM = 2;\nconst PINCH_ZOOM_SPEED = 0.002; // Más suave para gestos táctiles\nconst WHEEL_ZOOM_SPEED = 0.0007; // Más suave para rueda del mouse\nconst BUTTON_ZOOM_FACTOR = 1.1; // Más suave para botones\n\nconst Canvas = () => {\n  _s();\n  const {\n    images\n  } = useCanvas();\n  const [position, setPosition] = useState({\n    x: -10000,\n    y: -10000\n  });\n  const [zoom, setZoom] = useState(1);\n  const [wrappedPositions, setWrappedPositions] = useState([]);\n  useEffect(() => {\n    const wrapPositions = () => {\n      const baseX = position.x;\n      const baseY = position.y;\n      return [{\n        x: baseX - CANVAS_SIZE,\n        y: baseY - CANVAS_SIZE\n      }, {\n        x: baseX,\n        y: baseY - CANVAS_SIZE\n      }, {\n        x: baseX + CANVAS_SIZE,\n        y: baseY - CANVAS_SIZE\n      }, {\n        x: baseX - CANVAS_SIZE,\n        y: baseY\n      }, {\n        x: baseX,\n        y: baseY\n      }, {\n        x: baseX + CANVAS_SIZE,\n        y: baseY\n      }, {\n        x: baseX - CANVAS_SIZE,\n        y: baseY + CANVAS_SIZE\n      }, {\n        x: baseX,\n        y: baseY + CANVAS_SIZE\n      }, {\n        x: baseX + CANVAS_SIZE,\n        y: baseY + CANVAS_SIZE\n      }];\n    };\n    setWrappedPositions(wrapPositions());\n  }, [position]);\n\n  // Función de zoom con suavizado\n  const smoothZoom = newZoom => {\n    setZoom(Math.min(Math.max(newZoom, MIN_ZOOM), MAX_ZOOM));\n  };\n  const bind = useGesture({\n    onDrag: ({\n      delta: [dx, dy],\n      event\n    }) => {\n      event.preventDefault();\n      setPosition(current => {\n        const newX = current.x + dx / zoom;\n        const newY = current.y + dy / zoom;\n        return {\n          x: newX - Math.floor(newX / CANVAS_SIZE) * CANVAS_SIZE,\n          y: newY - Math.floor(newY / CANVAS_SIZE) * CANVAS_SIZE\n        };\n      });\n    },\n    onPinch: ({\n      event,\n      offset: [d],\n      movement: [md],\n      memo\n    }) => {\n      event.preventDefault();\n      if (!memo) {\n        memo = zoom;\n      }\n      const newZoom = memo + md * PINCH_ZOOM_SPEED;\n      smoothZoom(newZoom);\n      return memo;\n    },\n    onWheel: ({\n      event\n    }) => {\n      event.preventDefault();\n      const newZoom = zoom * (1 - event.deltaY * WHEEL_ZOOM_SPEED);\n      smoothZoom(newZoom);\n    }\n  }, {\n    drag: {\n      filterTaps: true,\n      rubberband: true\n    },\n    pinch: {\n      filterTaps: true,\n      rubberband: true,\n      threshold: 0,\n      preventDefault: true\n    },\n    wheel: {\n      filterTaps: true\n    }\n  });\n  const handleZoomIn = () => {\n    smoothZoom(zoom * BUTTON_ZOOM_FACTOR);\n  };\n  const handleZoomOut = () => {\n    smoothZoom(zoom / BUTTON_ZOOM_FACTOR);\n  };\n  return /*#__PURE__*/_jsxDEV(S.Viewport, {\n    children: [/*#__PURE__*/_jsxDEV(S.ZoomContainer, {\n      style: {\n        transform: `scale(${zoom})`\n      },\n      children: wrappedPositions.map((pos, index) => /*#__PURE__*/_jsxDEV(S.CanvasContainer, {\n        ...bind(),\n        style: {\n          transform: `translate(${pos.x}px, ${pos.y}px)`\n        },\n        children: images.map(image => /*#__PURE__*/_jsxDEV(Image, {\n          image: image,\n          style: {\n            position: 'absolute',\n            left: image.x,\n            top: image.y,\n            width: image.width,\n            height: image.height\n          }\n        }, image.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 15\n        }, this))\n      }, index, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(S.Controls, {\n      children: [/*#__PURE__*/_jsxDEV(S.ZoomButton, {\n        onClick: handleZoomIn,\n        children: \"+\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(S.ZoomButton, {\n        onClick: handleZoomOut,\n        children: \"-\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(S.Coordinates, {\n      children: [Math.round(-position.x), \", \", Math.round(-position.y), \" (\", zoom.toFixed(1), \"x)\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 101,\n    columnNumber: 5\n  }, this);\n};\n_s(Canvas, \"GbZnUX6AozZTSUf2LeT/g+E4AYg=\", false, function () {\n  return [useCanvas, useGesture];\n});\n_c = Canvas;\nexport default Canvas;\nvar _c;\n$RefreshReg$(_c, \"Canvas\");","map":{"version":3,"names":["React","useState","useEffect","useGesture","S","Image","useCanvas","jsxDEV","_jsxDEV","CANVAS_SIZE","MIN_ZOOM","MAX_ZOOM","PINCH_ZOOM_SPEED","WHEEL_ZOOM_SPEED","BUTTON_ZOOM_FACTOR","Canvas","_s","images","position","setPosition","x","y","zoom","setZoom","wrappedPositions","setWrappedPositions","wrapPositions","baseX","baseY","smoothZoom","newZoom","Math","min","max","bind","onDrag","delta","dx","dy","event","preventDefault","current","newX","newY","floor","onPinch","offset","d","movement","md","memo","onWheel","deltaY","drag","filterTaps","rubberband","pinch","threshold","wheel","handleZoomIn","handleZoomOut","Viewport","children","ZoomContainer","style","transform","map","pos","index","CanvasContainer","image","left","top","width","height","id","fileName","_jsxFileName","lineNumber","columnNumber","Controls","ZoomButton","onClick","Coordinates","round","toFixed","_c","$RefreshReg$"],"sources":["/Users/litl/Dropbox/Jona/litl/proyectos/artwall/src/components/Canvas/Canvas.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useGesture } from 'react-use-gesture';\nimport * as S from './Canvas.styles';\nimport Image from '../Image/Image';\nimport useCanvas from '../../hooks/useCanvas';\n\nconst CANVAS_SIZE = 20000;\nconst MIN_ZOOM = 0.1;\nconst MAX_ZOOM = 2;\nconst PINCH_ZOOM_SPEED = 0.002; // Más suave para gestos táctiles\nconst WHEEL_ZOOM_SPEED = 0.0007; // Más suave para rueda del mouse\nconst BUTTON_ZOOM_FACTOR = 1.1; // Más suave para botones\n\nconst Canvas = () => {\n  const { images } = useCanvas();\n  const [position, setPosition] = useState({ x: -10000, y: -10000 });\n  const [zoom, setZoom] = useState(1);\n  const [wrappedPositions, setWrappedPositions] = useState([]);\n\n  useEffect(() => {\n    const wrapPositions = () => {\n      const baseX = position.x;\n      const baseY = position.y;\n      \n      return [\n        { x: baseX - CANVAS_SIZE, y: baseY - CANVAS_SIZE },\n        { x: baseX, y: baseY - CANVAS_SIZE },\n        { x: baseX + CANVAS_SIZE, y: baseY - CANVAS_SIZE },\n        { x: baseX - CANVAS_SIZE, y: baseY },\n        { x: baseX, y: baseY },\n        { x: baseX + CANVAS_SIZE, y: baseY },\n        { x: baseX - CANVAS_SIZE, y: baseY + CANVAS_SIZE },\n        { x: baseX, y: baseY + CANVAS_SIZE },\n        { x: baseX + CANVAS_SIZE, y: baseY + CANVAS_SIZE },\n      ];\n    };\n\n    setWrappedPositions(wrapPositions());\n  }, [position]);\n\n  // Función de zoom con suavizado\n  const smoothZoom = (newZoom) => {\n    setZoom(Math.min(Math.max(newZoom, MIN_ZOOM), MAX_ZOOM));\n  };\n\n  const bind = useGesture({\n    onDrag: ({ delta: [dx, dy], event }) => {\n      event.preventDefault();\n      setPosition(current => {\n        const newX = current.x + dx / zoom;\n        const newY = current.y + dy / zoom;\n        \n        return {\n          x: newX - Math.floor(newX / CANVAS_SIZE) * CANVAS_SIZE,\n          y: newY - Math.floor(newY / CANVAS_SIZE) * CANVAS_SIZE\n        };\n      });\n    },\n    onPinch: ({ event, offset: [d], movement: [md], memo }) => {\n      event.preventDefault();\n\n      if (!memo) {\n        memo = zoom;\n      }\n\n      const newZoom = memo + md * PINCH_ZOOM_SPEED;\n      smoothZoom(newZoom);\n\n      return memo;\n    },\n    onWheel: ({ event }) => {\n      event.preventDefault();\n      const newZoom = zoom * (1 - event.deltaY * WHEEL_ZOOM_SPEED);\n      smoothZoom(newZoom);\n    }\n  }, {\n    drag: {\n      filterTaps: true,\n      rubberband: true\n    },\n    pinch: {\n      filterTaps: true,\n      rubberband: true,\n      threshold: 0,\n      preventDefault: true\n    },\n    wheel: {\n      filterTaps: true\n    }\n  });\n\n  const handleZoomIn = () => {\n    smoothZoom(zoom * BUTTON_ZOOM_FACTOR);\n  };\n\n  const handleZoomOut = () => {\n    smoothZoom(zoom / BUTTON_ZOOM_FACTOR);\n  };\n\n  return (\n    <S.Viewport>\n      <S.ZoomContainer\n        style={{\n          transform: `scale(${zoom})`\n        }}\n      >\n        {wrappedPositions.map((pos, index) => (\n          <S.CanvasContainer\n            key={index}\n            {...bind()}\n            style={{\n              transform: `translate(${pos.x}px, ${pos.y}px)`\n            }}\n          >\n            {images.map(image => (\n              <Image\n                key={image.id}\n                image={image}\n                style={{\n                  position: 'absolute',\n                  left: image.x,\n                  top: image.y,\n                  width: image.width,\n                  height: image.height\n                }}\n              />\n            ))}\n          </S.CanvasContainer>\n        ))}\n      </S.ZoomContainer>\n      \n      <S.Controls>\n        <S.ZoomButton onClick={handleZoomIn}>+</S.ZoomButton>\n        <S.ZoomButton onClick={handleZoomOut}>-</S.ZoomButton>\n      </S.Controls>\n      \n      <S.Coordinates>\n        {Math.round(-position.x)}, {Math.round(-position.y)} ({zoom.toFixed(1)}x)\n      </S.Coordinates>\n    </S.Viewport>\n  );\n};\n\nexport default Canvas; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}